<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../iron-icons/iron-icons.html">


<dom-module id="oc-transactions">
    <template>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <style include="shop-button" is="custom-style">

            :host {
                display: block;
                background: #fff;
                color: #000;
            }

            h3 {
                font-size:1.13em !important;
                margin: 10px 0 !important;
            }


            div.row {
                margin: 15px 0 !important;

            }

            .row-bordered{
                border-bottom: 1px solid #9e9e9e;

            }
        </style>
        <div class="container-fluid">
            <div class="card-content">
                <div class="row row-bordered">
                    <div class="col-xs-4 col-md-2">
                        <h3>Date</h3>
                    </div>
                    <div class="col-xs-3 col-md-2">
                        <h3>Amount</h3>
                    </div>
                    <div class="col-xs-2 col-md-2">
                        <h3>Status</h3>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-12">
                    <template is="dom-if" if="[[_empty]]">
                        No Records to display
                    </template>
                </div>
            </div>

            <template is="dom-repeat" items="[[transactions]]">

                <div class="card-content">
                    <div class="row row-bordered">
                        <div class="col-xs-12 col-md-12">
                        </div>
                        <div class="col-xs-4 col-md-2">
                            [[_isGetYear(item.dateTime)]] [[_isGetTime(item.dateTime)]]

                        </div>
                        <div class="col-xs-4 col-md-2">
                            <b>R[[_formatPrice(item.amount)]]</b>
                        </div>
                        <div class="col-xs-1 col-md-1">
                            <iron-icon  icon="[[_computeStatus(item.status)]]"></iron-icon>
                        </div>
                        <div class="col-xs-12 col-md-3">
                            <b>[[item.reference]]</b>
                        </div>
                        <div class="col-xs-12 col-md-3">
                            [[item.entryReference]]
                        </div>

                    </div>
                </div>
            </template>
        </div>
        </div>
    </template>
    <script>
        /**
         * `oc-transactions`
         * List of transactions
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class OcTransactions extends Polymer.Element {
            static get is() { return 'oc-transactions'; }
            static get properties() {
                return {
                    transactions: {
                        type: Array,
                        value: [],
                        observer: '_isEmpty'
                    },
                    _empty:{
                        Type: Boolean,
                        value: true
                    }
                };
            }
            ready() {
                super.ready();
            }

            _formatPrice(price){
                return  price.toFixed(2);
            }

            //check if there are records
            _isEmpty(){
                this._empty = !this.transactions.length > 0;
                console.log(this._empty);
            }

            //check if there are records
            _isGetYear(date){
                return /\d{4}-\d{2}-\d{2}/.exec(date);
            }

            //check if there are records
            _isGetTime(date){
                let d = new Date(date);
                return d.getHours() + ':' + d.getMinutes() + ':' + d.getSeconds();
            }

            //check if there are records
            _computeStatus(status){
                if(status === 'Success'){
                    return "check";
                } else if (status.indexOf("Pending") >= 0){
                    return "watch-later";
                } else {
                    return "error";
                }
            }
        }

        window.customElements.define(OcTransactions.is, OcTransactions);
    </script>
</dom-module>
